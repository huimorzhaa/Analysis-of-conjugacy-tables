<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Точный тест Фишера</title>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        table {border-collapse: collapse; margin: 20px 0;}
        td, th {border: 1px solid #ddd; padding: 8px;}
        th {background-color: #f2f2f2;}
        .warning {color: #856404; background-color: #fff3cd; padding: 15px; border-radius: 4px;}
    </style>
</head>
<body>
    <h1>Изучение таблиц сопряженности методом точного теста Фишера</h1>
    
    <p>Когда мы работаем с маленькими таблицами (особенно 2×2) и количеством наблюдений мало (например, в каких-то ячейках меньше 5 случаев), стандартные методы проверки связей становятся неточными. В таких случаях применяют точный тест Фишера.</p>

    <h2>Основные особенности теста</h2>
    <ul>
        <li>Идеально подходит для таблиц 2×2</li>
        <li>Работает с категориальными переменными (да/нет, успех/неудача)</li>
        <li>Рекомендован при малых выборках</li>
        <li>Даёт точные p-значения</li>
    </ul>

    <h2>Алгоритм расчета</h2>
    <ol>
        <li>Построить таблицу фактических частот:
            <table>
                <tr><th></th><th>Событие A</th><th>Не событие A</th><th>Всего</th></tr>
                <tr><td>Группа 1</td><td>a</td><td>b</td><td>a+b</td></tr>
                <tr><td>Группа 2</td><td>c</td><td>d</td><td>c+d</td></tr>
                <tr><td>Всего</td><td>a+c</td><td>b+d</td><td>n</td></tr>
            </table>
        </li>
        
        <li>Рассчитать вероятность наблюдавшейся таблицы:
            \[
            p = \frac{(a+b)!\,(c+d)!\,(a+c)!\,(b+d)!}{a!\,b!\,c!\,d!\,n!}
            \]
        </li>
        
        <li>Для двустороннего теста суммировать вероятности всех более экстремальных таблиц</li>
        
        <li>Сравнить p-значение с уровнем значимости:
            <ul>
                <li>Если \( p \leq 0.05 \) - связь статистически значима</li>
                <li>Если \( p > 0.05 \) - связь не обнаружена</li>
            </ul>
        </li>
    </ol>

    <h2>Пример расчета</h2>
    <p>Исследуем эффективность нового препарата:</p>
    
    <table>
        <tr><th></th><th>Выздоровел</th><th>Не выздоровел</th><th>Всего</th></tr>
        <tr><td>Лечился</td><td>8</td><td>2</td><td>10</td></tr>
        <tr><td>Не лечился</td><td>1</td><td>9</td><td>10</td></tr>
        <tr><td>Всего</td><td>9</td><td>11</td><td>20</td></tr>
    </table>

    <h3>Шаг 1. Идентификация переменных</h3>
    <p>
    \( a = 8,\ b = 2,\ c = 1,\ d = 9,\ n = 20 \)
    </p>

    <h3>Шаг 2. Подстановка в формулу</h3>
    <p>
    \[
    p = \frac{(8+2)!\,(1+9)!\,(8+1)!\,(2+9)!}{8!\,2!\,1!\,9!\,20!}
    \]
    </p>

    <h3>Шаг 3. Вычисление факториалов</h3>
    <p>
    \[
    \begin{align*}
    10! &= 3628800 \\
    9! &= 362880 \\
    11! &= 39916800 \\
    20! &= 2432902008176640000 \\
    \end{align*}
    \]
    </p>

    <h3>Шаг 4. Расчёт p-значения</h3>
    <p>После подстановки всех значений:</p>
    <p>
    \[
    p \approx 0.0015
    \]
    </p>

    <div class="warning">
        <strong>Важно!</strong> В реальных расчётах для вычисления факториалов 
        и комбинаторики следует использовать статистические программы 
        (R, Python, SPSS) или онлайн-калькуляторы.
    </div>

    <h3>Вывод</h3>
    <p>Полученное p-значение \( 0.0015 < 0.05 \), следовательно, 
    существует статистически значимая связь между лечением и выздоровлением.</p>
</body>
</html>
